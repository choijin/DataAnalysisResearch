<?xml version="1.0" encoding="UTF-8"?>
<rootTag>
<Award>
<AwardTitle>Closed-Loop Formal Verification of ICDs Using Cardiac Electrophysiological Models</AwardTitle>
<AGENCY>NSF</AGENCY>
<AwardEffectiveDate>12/01/2014</AwardEffectiveDate>
<AwardExpirationDate>08/31/2019</AwardExpirationDate>
<AwardTotalIntnAmount>162122.00</AwardTotalIntnAmount>
<AwardAmount>162122</AwardAmount>
<AwardInstrument>
<Value>Continuing Grant</Value>
</AwardInstrument>
<Organization>
<Code>05050000</Code>
<Directorate>
<Abbreviation>CSE</Abbreviation>
<LongName>Direct For Computer &amp; Info Scie &amp; Enginr</LongName>
</Directorate>
<Division>
<Abbreviation>CNS</Abbreviation>
<LongName>Division Of Computer and Network Systems</LongName>
</Division>
</Organization>
<ProgramOfficer>
<SignBlockName>David Corman</SignBlockName>
<PO_EMAI>dcorman@nsf.gov</PO_EMAI>
<PO_PHON>7032928754</PO_PHON>
</ProgramOfficer>
<AbstractNarration>Implantable Cardiac Defibrillators (ICDs) are at the forefront of preventing sudden death in patients suffering from ventricular arrhythmias.  ICDs have evolved into complex Cyber-Physical Systems (CPS)which tightly sensing, hardware, and software to diagnose arrythmias based on electrogram signals and control cardiac excitation. These devices are life-critical, yet the Verification and Validation (V&amp;V) techniques used for establishing their safety have remained somewhat informal, and rely largely on extensive unit testing. &lt;br/&gt;&lt;br/&gt;There have been a number of exciting developments in formal verification technologies. This proposal introduces these techniques into the ICD verification process, and will demonstrate their suitability for application in other medical devices. The project will develop a model-based framework for ICDs, and will apply formal verification techniques, such as model checking and reachability analysis, to high-fidelity cardiac electrophysiological models that capture the electrical excitation induced by the ICD's control software.  Through extensive collaboration with FDA research staff, the proposal will demonstrate the effectiveness of formal verification technology and suitability in medical device applications.</AbstractNarration>
<MinAmdLetterDate>11/24/2014</MinAmdLetterDate>
<MaxAmdLetterDate>11/30/2018</MaxAmdLetterDate>
<ARRAAmount/>
<TRAN_TYPE>Grant</TRAN_TYPE>
<CFDA_NUM>47.070</CFDA_NUM>
<NSF_PAR_USE_FLAG>0</NSF_PAR_USE_FLAG>
<FUND_AGCY_CODE>4900</FUND_AGCY_CODE>
<AWDG_AGCY_CODE>4900</AWDG_AGCY_CODE>
<AwardID>1445770</AwardID>
<Investigator>
<FirstName>Scott</FirstName>
<LastName>Smolka</LastName>
<PI_MID_INIT>A</PI_MID_INIT>
<PI_SUFX_NAME/>
<PI_FULL_NAME>Scott A Smolka</PI_FULL_NAME>
<EmailAddress>sas@cs.stonybrook.edu</EmailAddress>
<PI_PHON>6314732931</PI_PHON>
<NSF_ID>000172536</NSF_ID>
<StartDate>11/24/2014</StartDate>
<EndDate/>
<RoleCode>Principal Investigator</RoleCode>
</Investigator>
<Institution>
<Name>SUNY at Stony Brook</Name>
<CityName>Stony Brook</CityName>
<ZipCode>117940001</ZipCode>
<PhoneNumber>6316329949</PhoneNumber>
<StreetAddress>WEST 5510 FRK MEL LIB</StreetAddress>
<StreetAddress2/>
<CountryName>United States</CountryName>
<StateName>New York</StateName>
<StateCode>NY</StateCode>
<CONGRESSDISTRICT>01</CONGRESSDISTRICT>
<CONGRESS_DISTRICT_ORG>NY01</CONGRESS_DISTRICT_ORG>
<ORG_DUNS_NUM>804878247</ORG_DUNS_NUM>
<ORG_LGL_BUS_NAME>RESEARCH FOUNDATION FOR THE STATE UNIVERSITY OF NEW YORK, THE</ORG_LGL_BUS_NAME>
<ORG_PRNT_DUNS_NUM>020657151</ORG_PRNT_DUNS_NUM>
</Institution>
<Performance_Institution>
<Name><![CDATA[Stony Brook University]]></Name>
<CityName>Stony Brook</CityName>
<StateCode>NY</StateCode>
<ZipCode>117944400</ZipCode>
<StreetAddress><![CDATA[Department of Computer Science]]></StreetAddress>
<CountryCode>US</CountryCode>
<CountryName>United States</CountryName>
<StateName>New York</StateName>
<CountryFlag>1</CountryFlag>
<CONGRESSDISTRICT>01</CONGRESSDISTRICT>
<CONGRESS_DISTRICT_PERF>NY01</CONGRESS_DISTRICT_PERF>
</Performance_Institution>
<ProgramElement>
<Code>7918</Code>
<Text>CPS-Cyber-Physical Systems</Text>
</ProgramElement>
<Appropriation>
<Code>0115</Code>
<Name>NSF RESEARCH &amp; RELATED ACTIVIT</Name>
<APP_SYMB_ID>040100</APP_SYMB_ID>
</Appropriation>
<Appropriation>
<Code>0116</Code>
<Name>NSF RESEARCH &amp; RELATED ACTIVIT</Name>
<APP_SYMB_ID>040100</APP_SYMB_ID>
</Appropriation>
<FUND_OBLG>2015~79999</FUND_OBLG>
<FUND_OBLG>2016~82123</FUND_OBLG>
<POR>
<DRECONTENT><![CDATA[<div class="porColContainerWBG"> <div class="porContentCol"><p>The goal of this project was to develop a framework for the formal verification of ICD control software.&nbsp; An ICD or Implantable Cardioverter Defibrillator is an implantable medical device able to perform cardioversion, defibrillation, and pacing of the heart. &nbsp;It can therefore correct most life-threatening cardiac arrhythmias.&nbsp; Some of the main outcomes of the project are the following.</p> <p>1) Motivated by the problem of verifying the correctness of arrhythmia-detection algorithms, we developed a formalization of these algorithms in the language of Quantitative Regular Expressions.&nbsp; QREs are a flexible formal language for specifying complex numerical queries over data streams, with provable runtime and memory consumption guarantees. &nbsp;The medical-device algorithms of interest include <em>peak detection</em> (where a peak in a cardiac signal indicates a heartbeat) and various <em>discriminators</em>, each of which uses a feature of the cardiac signal to distinguish fatal from non-fatal arrhythmias. &nbsp;Expressing these algorithms' desired output in current temporal logics, and implementing them via monitor synthesis, is cumbersome, error-prone, computationally expensive, and sometimes infeasible. &nbsp;In contrast, we show that a range of peak detectors (in both the time and wavelet domains) and various discriminators at the heart of today's arrhythmia-detection devices are easily expressible in QREs.&nbsp; The fact that one formalism (QREs) is used to describe the desired end-to-end operation of an arrhythmia detector opens the way to formal analysis and rigorous testing of these detectors' correctness and performance. &nbsp;Such analysis could alleviate the regulatory burden on device developers when modifying their algorithms. &nbsp;The performance of the peak-detection QREs is demonstrated by running them on real patient data, on which they yield results on par with those provided by a cardiologist.</p> <p>2) An ICD reprogramming attack seeks to alter the device's parameters to induce unnecessary shocks and, even more egregious, prevent required therapy. &nbsp;We developed a formal approach for the synthesis of ICD reprogramming attacks that are both <em>effective</em>, i.e., lead to fundamental changes in the required therapy, and <em>stealthy</em>, i.e., involve minimal changes to the nominal ICD parameters. &nbsp;We focus on the discrimination algorithm underlying Boston Scientific devices (one of the principal ICD manufacturers) and formulate the synthesis problem as one of multi-objective optimization. &nbsp;Our solution technique is based on an Optimization Modulo Theories encoding of the problem and allows us to derive device parameters that are optimal with respect to the effectiveness-stealthiness tradeoff. &nbsp;To the best of our knowledge, our work is the first to derive systematic ICD reprogramming attacks designed to maximize therapy disruption while minimizing detection.</p> <p>3) We developed <em>continuous Lagrangian reachability</em> (CLRT), a new algorithm for verifying the correctness/safety of a nonlinear, time-variant dynamical systems. More technically, CLRT involves&nbsp;the computation of a tight and continuous-time &ldquo;reachtube&rdquo; for the system under investigation&rsquo;s solution flows. &nbsp;CLRT employs finite strain theory to determine the deformation of the solution set over time, and we have developed simple explicit analytic formulas for the optimal metric for this deformation.&nbsp; This approach is superior to prior work, which used semi-definite programming. &nbsp; Our results on a series of benchmarks show that CLRT performs favorably compared to state-of-the-art tools such as CAPD in terms of the continuous reachtube volumes they compute.&nbsp;</p> <p>4) Even though Model Predictive Control (MPC) is the most commonly used insulin-control algorithm for the <em>Artificial Pancreas</em> (AP), MPC typically requires complex online optimizations, which are infeasible for computation- and power-constrained AP devices.&nbsp; MPC is also prone to state-estimation errors.&nbsp; We have recently developed a new approach to AP control based on <em>Imitation Learning</em>.&nbsp; Our approach allows us to learn neural-network-based insulin policies from MPC-computed examples.&nbsp; The insulin policies we learn in this manner are computationally efficient and, by instrumenting the MPC controller at training time with full state information, they can directly map system observations into optimal therapy decisions, thus bypassing state estimation.&nbsp; We apply Bayesian inference for learning the policies, which allows us to quantify prediction uncertainty (resulting, for instance, from patient physiological variations) and make conservative therapy decisions accordingly.&nbsp; We demonstrate that the control policies we obtain generalize well to the subjects in a patient cohort representing different model parameters and meal behaviors.</p> <p>5) Two Post Doctoral students, Greg Byrne and Nicola Paoletti, were supported by the award. &nbsp;&nbsp;Four high students were also involved in the project.&nbsp; Two of them participated in our research on the cyber-security of medical devices, with a focus on ICDs and pacemakers.&nbsp; To prepare for this research, they did substantial background reading on the physiology of the human heart and on ICD arrhythmia discrimination algorithms.&nbsp; One of the students, Zachary Gruber, was a co-author on an ICCPS 2019 paper on Synthesizing Stealthy Reprogramming Attacks on ICDs.&nbsp; Zach attended the April 2018 CyberCardia PI meeting at Georgia Tech, where he gave a presentation on his work.&nbsp; CyberCardia is an NSF CPS Frontier project lead by Scott Smolka, the PI on Award 1445770.</p> <p>&nbsp;</p> <p>&nbsp;</p><br> <p>            Last Modified: 12/02/2019<br>      Modified by: Scott&nbsp;A&nbsp;Smolka</p> </div> <div class="porSideCol"></div> </div>]]></DRECONTENT>
<POR_COPY_TXT><![CDATA[ The goal of this project was to develop a framework for the formal verification of ICD control software.  An ICD or Implantable Cardioverter Defibrillator is an implantable medical device able to perform cardioversion, defibrillation, and pacing of the heart.  It can therefore correct most life-threatening cardiac arrhythmias.  Some of the main outcomes of the project are the following.  1) Motivated by the problem of verifying the correctness of arrhythmia-detection algorithms, we developed a formalization of these algorithms in the language of Quantitative Regular Expressions.  QREs are a flexible formal language for specifying complex numerical queries over data streams, with provable runtime and memory consumption guarantees.  The medical-device algorithms of interest include peak detection (where a peak in a cardiac signal indicates a heartbeat) and various discriminators, each of which uses a feature of the cardiac signal to distinguish fatal from non-fatal arrhythmias.  Expressing these algorithms' desired output in current temporal logics, and implementing them via monitor synthesis, is cumbersome, error-prone, computationally expensive, and sometimes infeasible.  In contrast, we show that a range of peak detectors (in both the time and wavelet domains) and various discriminators at the heart of today's arrhythmia-detection devices are easily expressible in QREs.  The fact that one formalism (QREs) is used to describe the desired end-to-end operation of an arrhythmia detector opens the way to formal analysis and rigorous testing of these detectors' correctness and performance.  Such analysis could alleviate the regulatory burden on device developers when modifying their algorithms.  The performance of the peak-detection QREs is demonstrated by running them on real patient data, on which they yield results on par with those provided by a cardiologist.  2) An ICD reprogramming attack seeks to alter the device's parameters to induce unnecessary shocks and, even more egregious, prevent required therapy.  We developed a formal approach for the synthesis of ICD reprogramming attacks that are both effective, i.e., lead to fundamental changes in the required therapy, and stealthy, i.e., involve minimal changes to the nominal ICD parameters.  We focus on the discrimination algorithm underlying Boston Scientific devices (one of the principal ICD manufacturers) and formulate the synthesis problem as one of multi-objective optimization.  Our solution technique is based on an Optimization Modulo Theories encoding of the problem and allows us to derive device parameters that are optimal with respect to the effectiveness-stealthiness tradeoff.  To the best of our knowledge, our work is the first to derive systematic ICD reprogramming attacks designed to maximize therapy disruption while minimizing detection.  3) We developed continuous Lagrangian reachability (CLRT), a new algorithm for verifying the correctness/safety of a nonlinear, time-variant dynamical systems. More technically, CLRT involves the computation of a tight and continuous-time "reachtube" for the system under investigation’s solution flows.  CLRT employs finite strain theory to determine the deformation of the solution set over time, and we have developed simple explicit analytic formulas for the optimal metric for this deformation.  This approach is superior to prior work, which used semi-definite programming.   Our results on a series of benchmarks show that CLRT performs favorably compared to state-of-the-art tools such as CAPD in terms of the continuous reachtube volumes they compute.   4) Even though Model Predictive Control (MPC) is the most commonly used insulin-control algorithm for the Artificial Pancreas (AP), MPC typically requires complex online optimizations, which are infeasible for computation- and power-constrained AP devices.  MPC is also prone to state-estimation errors.  We have recently developed a new approach to AP control based on Imitation Learning.  Our approach allows us to learn neural-network-based insulin policies from MPC-computed examples.  The insulin policies we learn in this manner are computationally efficient and, by instrumenting the MPC controller at training time with full state information, they can directly map system observations into optimal therapy decisions, thus bypassing state estimation.  We apply Bayesian inference for learning the policies, which allows us to quantify prediction uncertainty (resulting, for instance, from patient physiological variations) and make conservative therapy decisions accordingly.  We demonstrate that the control policies we obtain generalize well to the subjects in a patient cohort representing different model parameters and meal behaviors.  5) Two Post Doctoral students, Greg Byrne and Nicola Paoletti, were supported by the award.   Four high students were also involved in the project.  Two of them participated in our research on the cyber-security of medical devices, with a focus on ICDs and pacemakers.  To prepare for this research, they did substantial background reading on the physiology of the human heart and on ICD arrhythmia discrimination algorithms.  One of the students, Zachary Gruber, was a co-author on an ICCPS 2019 paper on Synthesizing Stealthy Reprogramming Attacks on ICDs.  Zach attended the April 2018 CyberCardia PI meeting at Georgia Tech, where he gave a presentation on his work.  CyberCardia is an NSF CPS Frontier project lead by Scott Smolka, the PI on Award 1445770.             Last Modified: 12/02/2019       Submitted by: Scott A Smolka]]></POR_COPY_TXT>
</POR>
</Award>
</rootTag>
