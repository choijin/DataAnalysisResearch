<?xml version="1.0" encoding="UTF-8"?>
<rootTag>
<Award>
<AwardTitle>TWC: Small: Abstract Semantic Processing for Script Security</AwardTitle>
<AGENCY>NSF</AGENCY>
<AwardEffectiveDate>09/01/2012</AwardEffectiveDate>
<AwardExpirationDate>08/31/2015</AwardExpirationDate>
<AwardTotalIntnAmount>226935.00</AwardTotalIntnAmount>
<AwardAmount>226935</AwardAmount>
<AwardInstrument>
<Value>Standard Grant</Value>
</AwardInstrument>
<Organization>
<Code>05050000</Code>
<Directorate>
<Abbreviation>CSE</Abbreviation>
<LongName>Direct For Computer &amp; Info Scie &amp; Enginr</LongName>
</Directorate>
<Division>
<Abbreviation>CNS</Abbreviation>
<LongName>Division Of Computer and Network Systems</LongName>
</Division>
</Organization>
<ProgramOfficer>
<SignBlockName>Sol Greenspan</SignBlockName>
<PO_EMAI>sgreensp@nsf.gov</PO_EMAI>
<PO_PHON>7032927841</PO_PHON>
</ProgramOfficer>
<AbstractNarration>Much of the internet's business is conducted with dynamically generated documents --- HTML pages, SQL queries, and execution scripts --- that are generated on-the-fly by document-generator scripts written in PHP, Javascript, and JSP.  The situation is a threat to internet security because the document-generator scripts are often faulty, generating malformed documents that are vulnerable to attackers.  To remove this vulnerability, a new approach, abstract parsing, is developed and applied to enforce, in advance of execution, that every dynamically generated document emitted from a script will be grammatically well formed (spelled correctly).  The technique also predicts the range of semantics (intended meanings) of the generated documents, to help prevent attacker exploitation.  The impact of the research lies in its tools and methodologies to help programmers assemble a more secure internet.&lt;br/&gt;&lt;br/&gt;The technical approach starts from a document-generator script and a context-free reference grammar for the document language and generates an LALR(1)-parser from the grammar, applying it within a data-flow analysis of the script to predict the LALR-grammatical structure of the string-documents to be generated by the script.  The analysis computes abstract LALR-parse stacks that overapproximate the grammatical structure of the string-documents that the script generates.  &lt;br/&gt;Attribute-grammar machinery predicts the context-sensitive and semantical properties of the documents to be generated.  The technology is applied to (i) generate a semantically-aware implementation of taint analysis; (ii) implement automata-defined filters for dynamic string updates; (iii) combine abstract-interpretation technology with abstract parsing to analyze a wider class of program constructions, in particular, dictionary data structures.</AbstractNarration>
<MinAmdLetterDate>08/13/2012</MinAmdLetterDate>
<MaxAmdLetterDate>08/13/2012</MaxAmdLetterDate>
<ARRAAmount/>
<TRAN_TYPE>Grant</TRAN_TYPE>
<CFDA_NUM>47.070</CFDA_NUM>
<NSF_PAR_USE_FLAG>0</NSF_PAR_USE_FLAG>
<FUND_AGCY_CODE>4900</FUND_AGCY_CODE>
<AWDG_AGCY_CODE>4900</AWDG_AGCY_CODE>
<AwardID>1219746</AwardID>
<Investigator>
<FirstName>David</FirstName>
<LastName>Schmidt</LastName>
<PI_MID_INIT>A</PI_MID_INIT>
<PI_SUFX_NAME/>
<PI_FULL_NAME>David A Schmidt</PI_FULL_NAME>
<EmailAddress>das@ksu.edu</EmailAddress>
<PI_PHON>7855326350</PI_PHON>
<NSF_ID>000410449</NSF_ID>
<StartDate>08/13/2012</StartDate>
<EndDate/>
<RoleCode>Principal Investigator</RoleCode>
</Investigator>
<Institution>
<Name>Kansas State University</Name>
<CityName>Manhattan</CityName>
<ZipCode>665061100</ZipCode>
<PhoneNumber>7855326804</PhoneNumber>
<StreetAddress>2 FAIRCHILD HALL</StreetAddress>
<StreetAddress2><![CDATA[1601 VATTIER STREET]]></StreetAddress2>
<CountryName>United States</CountryName>
<StateName>Kansas</StateName>
<StateCode>KS</StateCode>
<CONGRESSDISTRICT>01</CONGRESSDISTRICT>
<CONGRESS_DISTRICT_ORG>KS01</CONGRESS_DISTRICT_ORG>
<ORG_DUNS_NUM>929773554</ORG_DUNS_NUM>
<ORG_LGL_BUS_NAME>KANSAS STATE UNIVERSITY</ORG_LGL_BUS_NAME>
<ORG_PRNT_DUNS_NUM>041146432</ORG_PRNT_DUNS_NUM>
</Institution>
<Performance_Institution>
<Name><![CDATA[Kansas State University]]></Name>
<CityName>Manhattan</CityName>
<StateCode>KS</StateCode>
<ZipCode>665061103</ZipCode>
<StreetAddress><![CDATA[2 Fairchild Hall]]></StreetAddress>
<CountryCode>US</CountryCode>
<CountryName>United States</CountryName>
<StateName>Kansas</StateName>
<CountryFlag>1</CountryFlag>
<CONGRESSDISTRICT>01</CONGRESSDISTRICT>
<CONGRESS_DISTRICT_PERF>KS01</CONGRESS_DISTRICT_PERF>
</Performance_Institution>
<ProgramElement>
<Code>8060</Code>
<Text>Secure &amp;Trustworthy Cyberspace</Text>
</ProgramElement>
<ProgramReference>
<Code>7434</Code>
<Text>CNCI</Text>
</ProgramReference>
<ProgramReference>
<Code>7923</Code>
<Text>SMALL PROJECT</Text>
</ProgramReference>
<ProgramReference>
<Code>9150</Code>
<Text>EXP PROG TO STIM COMP RES</Text>
</ProgramReference>
<Appropriation>
<Code>0112</Code>
<Name>NSF RESEARCH &amp; RELATED ACTIVIT</Name>
<APP_SYMB_ID>040100</APP_SYMB_ID>
</Appropriation>
<FUND_OBLG>2012~226935</FUND_OBLG>
<POR>
<DRECONTENT><![CDATA[<div class="porColContainerWBG"> <div class="porContentCol"><p>This project developed and implemented a methodology and a toolset that analyzes and validates, in advance of execution, scripts that dynamically generate HMTL, XML, and SQL documents assembled from strings generated by document-generator scripts.&nbsp; A script validated by the method is guaranteed to generate only grammatically well-formed string-documents. (Document-generating scripts are common to the World Wide Web and are notorious for generating faulty and even dangerous documents that generate server errors or security breaches. Precious little is available for checking these scripts in advance of their deployment.)<br /><br />Given a document-generator script (e.g., written in Javascript, PHP, JSP, etc.) and given the context-free reference grammar for the document language (e.g., a grammar for HTML), the analysis generates an LALR(1)-parser from the reference grammar and partially evaluates it within a data-flow analysis of the script to predict the LALR-grammatical structure of the string-documents to be generated by the script.&nbsp; The analysis does this by computing abstract LALR-parse stacks that overapproximate the structure of the string-documents that the script generates.&nbsp; The stacks encode the context-free structure of the documents, giving more precision than existing techniques.<br /><br />In addition, attribute-grammar machinery is used to predict the context-sensitive and semantical properties of the documents to be generated. Again, the analysis and validation is undertaken on the script itself prior to its deployment.<br /><br />The project improved abstract parsing to  handle attribute grammars, and we applied the improved method to  realistic application scripts written in JSP, a scripting language that  generates dynamically HTML documents.</p> <p>The abstract-parsing implementation was improved with a newly written  parser for PHP, the script-writing language that is analyzed.&nbsp; In  addition, the parser was augmented by "error recovery" routines that  repair the scripts when they generate faulty HTML output pages.</p> <dl class="clearing"><dt>The improved tool was tested on a  standard test suite of PHP-coded, HTML-generating scripts, and the  results showed that the approach is useful in practice. In this way, we<br /></dt><dt>(i) validated the feasibility of abstract parsing extended with semantic-attribute processing, and</dt><dt>(ii) valdiated that abstract parsing was capable of not only   uncovering errors in PHP scripts that generate HTML documents but also   correcting those errors automatically.</dt><dd> </dd></dl> <p>The intellectual merit of the work lies in its synthesis of parsing theory, data-flow analysis, and semantic analysis to validate correctness of document-generator scripts in advance of their deployment. Once a script is validated, the documents generated by it must be correct &mdash; run-time monitoring is minimized or even unnecessary.<br /><br />The broader impact of the research lies in (i) making a more secure internet; (ii) constructing a tool that is used like a type checker to raise confidence in the correctness of a script; and (iii) developing a methodology that has potential to transform how practitioners approach dynamic document generation for the World Wide Web.</p><br> <p>            Last Modified: 10/20/2015<br>      Modified by: David&nbsp;A&nbsp;Schmidt</p> </div> <div class="porSideCol"></div> </div>]]></DRECONTENT>
<POR_COPY_TXT><![CDATA[ This project developed and implemented a methodology and a toolset that analyzes and validates, in advance of execution, scripts that dynamically generate HMTL, XML, and SQL documents assembled from strings generated by document-generator scripts.  A script validated by the method is guaranteed to generate only grammatically well-formed string-documents. (Document-generating scripts are common to the World Wide Web and are notorious for generating faulty and even dangerous documents that generate server errors or security breaches. Precious little is available for checking these scripts in advance of their deployment.)  Given a document-generator script (e.g., written in Javascript, PHP, JSP, etc.) and given the context-free reference grammar for the document language (e.g., a grammar for HTML), the analysis generates an LALR(1)-parser from the reference grammar and partially evaluates it within a data-flow analysis of the script to predict the LALR-grammatical structure of the string-documents to be generated by the script.  The analysis does this by computing abstract LALR-parse stacks that overapproximate the structure of the string-documents that the script generates.  The stacks encode the context-free structure of the documents, giving more precision than existing techniques.  In addition, attribute-grammar machinery is used to predict the context-sensitive and semantical properties of the documents to be generated. Again, the analysis and validation is undertaken on the script itself prior to its deployment.  The project improved abstract parsing to  handle attribute grammars, and we applied the improved method to  realistic application scripts written in JSP, a scripting language that  generates dynamically HTML documents.  The abstract-parsing implementation was improved with a newly written  parser for PHP, the script-writing language that is analyzed.  In  addition, the parser was augmented by "error recovery" routines that  repair the scripts when they generate faulty HTML output pages. The improved tool was tested on a  standard test suite of PHP-coded, HTML-generating scripts, and the  results showed that the approach is useful in practice. In this way, we (i) validated the feasibility of abstract parsing extended with semantic-attribute processing, and(ii) valdiated that abstract parsing was capable of not only   uncovering errors in PHP scripts that generate HTML documents but also   correcting those errors automatically.   The intellectual merit of the work lies in its synthesis of parsing theory, data-flow analysis, and semantic analysis to validate correctness of document-generator scripts in advance of their deployment. Once a script is validated, the documents generated by it must be correct &mdash; run-time monitoring is minimized or even unnecessary.  The broader impact of the research lies in (i) making a more secure internet; (ii) constructing a tool that is used like a type checker to raise confidence in the correctness of a script; and (iii) developing a methodology that has potential to transform how practitioners approach dynamic document generation for the World Wide Web.       Last Modified: 10/20/2015       Submitted by: David A Schmidt]]></POR_COPY_TXT>
</POR>
</Award>
</rootTag>
