<?xml version="1.0" encoding="UTF-8"?>
<rootTag>
<Award>
<AwardTitle>AF: Small: Algorithms for computing aggregate functions of matrices with applications to Lattice QCD</AwardTitle>
<AGENCY>NSF</AGENCY>
<AwardEffectiveDate>09/01/2012</AwardEffectiveDate>
<AwardExpirationDate>08/31/2016</AwardExpirationDate>
<AwardTotalIntnAmount>400000.00</AwardTotalIntnAmount>
<AwardAmount>400000</AwardAmount>
<AwardInstrument>
<Value>Standard Grant</Value>
</AwardInstrument>
<Organization>
<Code>05010000</Code>
<Directorate>
<Abbreviation>CSE</Abbreviation>
<LongName>Direct For Computer &amp; Info Scie &amp; Enginr</LongName>
</Directorate>
<Division>
<Abbreviation>CCF</Abbreviation>
<LongName>Division of Computing and Communication Foundations</LongName>
</Division>
</Organization>
<ProgramOfficer>
<SignBlockName>Jack S. Snoeyink</SignBlockName>
<PO_EMAI>jsnoeyin@nsf.gov</PO_EMAI>
<PO_PHON>7032920000</PO_PHON>
</ProgramOfficer>
<AbstractNarration>One of the most computationally challenging tasks in Numerical Linear &lt;br/&gt;Algebra (NLA) is the estimation of the trace or the determinant of functions &lt;br/&gt;of matrices. The computational difficulty arises for very large matrices &lt;br/&gt;where the computation of the entire spectrum is infeasible. Traditionally, &lt;br/&gt;this problem is approached through stochastic techniques, such as Monte &lt;br/&gt;Carlo, where each step involves the solution of a linear system of equations. &lt;br/&gt;Deterministic techniques could provide approximations much faster but &lt;br/&gt;introduce bias in the result. This research will employ a combination of &lt;br/&gt;these techniques. Deterministic techniques involve novel uses of &lt;br/&gt;traditional NLA tools such as low rank approximations, deflation, and &lt;br/&gt;preconditioners, not only for speeding the solution of linear systems but also &lt;br/&gt;for reducing the variance of the stochastic process. The team plans to use Hadamard &lt;br/&gt;vectors, which are popular in coding theory, with an ordering induced by &lt;br/&gt;hierarchical graph-coloring, to produce a deterministic sequence of sampling &lt;br/&gt;vectors for Monte Carlo that exploits the structure of the matrix.&lt;br/&gt;&lt;br/&gt;Although most of these techniques address the general NLA problem, the &lt;br/&gt;motivating application is lattice quantum chromodynamics (LQCD). The goal &lt;br/&gt;of LQCD is to calculate the properties, structure, and interactions of hadrons,&lt;br/&gt;the basic constituents of matter. Computation of observables in LQCD entails &lt;br/&gt;averaging of correlation functions over an ensemble of gauge fields. &lt;br/&gt;These correlation functions often require the trace of the inverse of a large &lt;br/&gt;sparse matrix, or the ratio of determinants of two such matrices. &lt;br/&gt;&lt;br/&gt;It is increasingly clear that there is an opportunity for real gains by &lt;br/&gt;harnessing the synergy between randomized and deterministic techniques.&lt;br/&gt;Based on such an approach, this research will advance the current &lt;br/&gt;state-of-the-art in NLA, while transforming some of the standard computational &lt;br/&gt;practices in LQCD. It will also be useful in other disciplines, as the &lt;br/&gt;problem  is common in many statistical applications, in data mining, &lt;br/&gt;in uncertainty quantification, as well as in quantum physics applications &lt;br/&gt;such as quantum Monte Carlo.</AbstractNarration>
<MinAmdLetterDate>07/30/2012</MinAmdLetterDate>
<MaxAmdLetterDate>07/30/2012</MaxAmdLetterDate>
<ARRAAmount/>
<TRAN_TYPE>Grant</TRAN_TYPE>
<CFDA_NUM>47.070</CFDA_NUM>
<NSF_PAR_USE_FLAG>0</NSF_PAR_USE_FLAG>
<FUND_AGCY_CODE>4900</FUND_AGCY_CODE>
<AWDG_AGCY_CODE>4900</AWDG_AGCY_CODE>
<AwardID>1218349</AwardID>
<Investigator>
<FirstName>Andreas</FirstName>
<LastName>Stathopoulos</LastName>
<PI_MID_INIT/>
<PI_SUFX_NAME/>
<PI_FULL_NAME>Andreas Stathopoulos</PI_FULL_NAME>
<EmailAddress>andreas@cs.wm.edu</EmailAddress>
<PI_PHON>7572213483</PI_PHON>
<NSF_ID>000346145</NSF_ID>
<StartDate>07/30/2012</StartDate>
<EndDate/>
<RoleCode>Principal Investigator</RoleCode>
</Investigator>
<Investigator>
<FirstName>Kostas</FirstName>
<LastName>Orginos</LastName>
<PI_MID_INIT/>
<PI_SUFX_NAME/>
<PI_FULL_NAME>Kostas Orginos</PI_FULL_NAME>
<EmailAddress>kostas@wm.edu</EmailAddress>
<PI_PHON>7572213524</PI_PHON>
<NSF_ID>000110491</NSF_ID>
<StartDate>07/30/2012</StartDate>
<EndDate/>
<RoleCode>Co-Principal Investigator</RoleCode>
</Investigator>
<Institution>
<Name>College of William and Mary</Name>
<CityName>Williamsburg</CityName>
<ZipCode>231878795</ZipCode>
<PhoneNumber>7572213966</PhoneNumber>
<StreetAddress>Office of Sponsored Programs</StreetAddress>
<StreetAddress2><![CDATA[P.O. Box 8795]]></StreetAddress2>
<CountryName>United States</CountryName>
<StateName>Virginia</StateName>
<StateCode>VA</StateCode>
<CONGRESSDISTRICT>02</CONGRESSDISTRICT>
<CONGRESS_DISTRICT_ORG>VA02</CONGRESS_DISTRICT_ORG>
<ORG_DUNS_NUM>074762238</ORG_DUNS_NUM>
<ORG_LGL_BUS_NAME>COLLEGE OF WILLIAM &amp; MARY, THE</ORG_LGL_BUS_NAME>
<ORG_PRNT_DUNS_NUM>074762238</ORG_PRNT_DUNS_NUM>
</Institution>
<Performance_Institution>
<Name><![CDATA[College of William and Mary]]></Name>
<CityName/>
<StateCode>VA</StateCode>
<ZipCode>231878795</ZipCode>
<StreetAddress/>
<CountryCode>US</CountryCode>
<CountryName>United States</CountryName>
<StateName>Virginia</StateName>
<CountryFlag>1</CountryFlag>
<CONGRESSDISTRICT>02</CONGRESSDISTRICT>
<CONGRESS_DISTRICT_PERF>VA02</CONGRESS_DISTRICT_PERF>
</Performance_Institution>
<ProgramElement>
<Code>7796</Code>
<Text>Algorithmic Foundations</Text>
</ProgramElement>
<ProgramReference>
<Code>7923</Code>
<Text>SMALL PROJECT</Text>
</ProgramReference>
<ProgramReference>
<Code>7933</Code>
<Text>NUM, SYMBOL, &amp; ALGEBRA COMPUT</Text>
</ProgramReference>
<Appropriation>
<Code>0112</Code>
<Name>NSF RESEARCH &amp; RELATED ACTIVIT</Name>
<APP_SYMB_ID>040100</APP_SYMB_ID>
</Appropriation>
<FUND_OBLG>2012~400000</FUND_OBLG>
<POR>
<DRECONTENT><![CDATA[<div class="porColContainerWBG"> <div class="porContentCol"><p>One of the most computationally challenging tasks in Numerical Linear Algebra (NLA) is the estimation of the trace of functions of matrices. &nbsp;The computational difficulty arises for very large matrices where the computation of the entire spectrum is infeasible. Examples abound in statistics, uncertainty quantification, as well as in calculations from quantum mechanics and high energy physics. Most commonly, the trace of the inverse of a matrix is needed. Traditionally, this problem is approached through stochastic techniques, such as Monte Carlo (MC), where each step involves the solution of a linear system of equations. &nbsp;The computational challenge, therefore, is (i) to reduce the large number of such steps required, and (ii) speedup the solution of the linear systems.<br /><br />To reduce the number of MC steps, we need to reduce the variance of the estimator. We have focused on deterministic methods that are combined with stochastic ones so that our estimators remain unbiased. Classical probing is a technique that uses matrix-vector multiplications to identify the most important structure of the inverse of A, whose contribution to the MC variance can then be removed. This is performed by coloring the graph of powers A^k, which becomes computationally intractable for large k.<br /><br />One of our main contributions was the development of Hierarchical Probing. On a lattice, coloring A^k can be achieved with an approximate but efficient manner. Moreover, the colorings can be hierarchical, i.e., nodes that share the same color for some k, they also share colors for smaller k. This allows for extremely efficient implementations that maintain all the advantages of the classical probing. Hierarchical probing has found broad use in the area of Lattice Quantum Chromodynamics where are collaborators report significant speedups. For general matrices where classical probing would work if it were tractable, we have developed a multilevel method that performs probing based on coloring successively coarsified versions of A^k and thus can be performed much more efficiently.<br /><br />A second contribution of this work is the use of deflation techniques for variance reduction but also as a way to speed up the solution of the linear systems. Deflation means to project out from the matrix its singular vector space with singular values near zero. Then we can split our trace computation into one in the deflation space, which can be performed easily, and one for the deflated matrix which should have much smaller variance for the MC process. Our research overcame two obstacles, one theoretical and one computational.&nbsp;<br /><br />Based on random matrix theory, we showed the surprising theoretical result that for Hermitian matrices variance reduces only if their singular value distribution increases faster than linearly, while for non-Hermitian matrices it always reduces. We further quantified the improvements in variance with relation to the singular value distribution. When applied to our motivating Lattice QCD application, we observed that deflation works in a complementary way with Hierarchical probing, together yielding speedups of close to two orders of magnitude.<br /><br />The computational problem that had to be solved was the efficient computation of a relatively large part of the near zero singular spectrum. Realizing that current software was not sufficient for our purposes, we developed new algorithms and extensions to our state-of-the-art eigensolver PRIMME, addressing a host of issues relating to interior eigenvalues and high accuracy computations. Moreover, we interfaced with a multigrid Lattice QCD preconditioner that speeds up PRIMME by a factor of 30.&nbsp;<br /><br />We have also made several other contributions, such as using deflation and preconditioners with interpolation to find the diagonal of the matrix inverse, applying our methods in a variety of other applications from Big Data, and improving the state-of-the-art in eigenvalue and singular value software. Overall, this project has given rise to new methods, algorithms, and software that are important on their own for Numerical Linear Algebra. In addition, they have enabled and continue to enable large scale calculations in Lattice QCD, and possibly many other applications.</p><br> <p>            Last Modified: 11/14/2016<br>      Modified by: Andreas&nbsp;Stathopoulos</p> </div> <div class="porSideCol"></div> </div>]]></DRECONTENT>
<POR_COPY_TXT><![CDATA[ One of the most computationally challenging tasks in Numerical Linear Algebra (NLA) is the estimation of the trace of functions of matrices.  The computational difficulty arises for very large matrices where the computation of the entire spectrum is infeasible. Examples abound in statistics, uncertainty quantification, as well as in calculations from quantum mechanics and high energy physics. Most commonly, the trace of the inverse of a matrix is needed. Traditionally, this problem is approached through stochastic techniques, such as Monte Carlo (MC), where each step involves the solution of a linear system of equations.  The computational challenge, therefore, is (i) to reduce the large number of such steps required, and (ii) speedup the solution of the linear systems.  To reduce the number of MC steps, we need to reduce the variance of the estimator. We have focused on deterministic methods that are combined with stochastic ones so that our estimators remain unbiased. Classical probing is a technique that uses matrix-vector multiplications to identify the most important structure of the inverse of A, whose contribution to the MC variance can then be removed. This is performed by coloring the graph of powers A^k, which becomes computationally intractable for large k.  One of our main contributions was the development of Hierarchical Probing. On a lattice, coloring A^k can be achieved with an approximate but efficient manner. Moreover, the colorings can be hierarchical, i.e., nodes that share the same color for some k, they also share colors for smaller k. This allows for extremely efficient implementations that maintain all the advantages of the classical probing. Hierarchical probing has found broad use in the area of Lattice Quantum Chromodynamics where are collaborators report significant speedups. For general matrices where classical probing would work if it were tractable, we have developed a multilevel method that performs probing based on coloring successively coarsified versions of A^k and thus can be performed much more efficiently.  A second contribution of this work is the use of deflation techniques for variance reduction but also as a way to speed up the solution of the linear systems. Deflation means to project out from the matrix its singular vector space with singular values near zero. Then we can split our trace computation into one in the deflation space, which can be performed easily, and one for the deflated matrix which should have much smaller variance for the MC process. Our research overcame two obstacles, one theoretical and one computational.   Based on random matrix theory, we showed the surprising theoretical result that for Hermitian matrices variance reduces only if their singular value distribution increases faster than linearly, while for non-Hermitian matrices it always reduces. We further quantified the improvements in variance with relation to the singular value distribution. When applied to our motivating Lattice QCD application, we observed that deflation works in a complementary way with Hierarchical probing, together yielding speedups of close to two orders of magnitude.  The computational problem that had to be solved was the efficient computation of a relatively large part of the near zero singular spectrum. Realizing that current software was not sufficient for our purposes, we developed new algorithms and extensions to our state-of-the-art eigensolver PRIMME, addressing a host of issues relating to interior eigenvalues and high accuracy computations. Moreover, we interfaced with a multigrid Lattice QCD preconditioner that speeds up PRIMME by a factor of 30.   We have also made several other contributions, such as using deflation and preconditioners with interpolation to find the diagonal of the matrix inverse, applying our methods in a variety of other applications from Big Data, and improving the state-of-the-art in eigenvalue and singular value software. Overall, this project has given rise to new methods, algorithms, and software that are important on their own for Numerical Linear Algebra. In addition, they have enabled and continue to enable large scale calculations in Lattice QCD, and possibly many other applications.       Last Modified: 11/14/2016       Submitted by: Andreas Stathopoulos]]></POR_COPY_TXT>
</POR>
</Award>
</rootTag>
