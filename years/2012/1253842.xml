<?xml version="1.0" encoding="UTF-8"?>
<rootTag>
<Award>
<AwardTitle>CAREER: Medical Cyber-Physical Systems</AwardTitle>
<AGENCY>NSF</AGENCY>
<AwardEffectiveDate>06/01/2013</AwardEffectiveDate>
<AwardExpirationDate>05/31/2019</AwardExpirationDate>
<AwardTotalIntnAmount>410000.00</AwardTotalIntnAmount>
<AwardAmount>410000</AwardAmount>
<AwardInstrument>
<Value>Continuing Grant</Value>
</AwardInstrument>
<Organization>
<Code>05050000</Code>
<Directorate>
<Abbreviation>CSE</Abbreviation>
<LongName>Direct For Computer &amp; Info Scie &amp; Enginr</LongName>
</Directorate>
<Division>
<Abbreviation>CNS</Abbreviation>
<LongName>Division Of Computer and Network Systems</LongName>
</Division>
</Organization>
<ProgramOfficer>
<SignBlockName>Marilyn McClure</SignBlockName>
<PO_EMAI>mmcclure@nsf.gov</PO_EMAI>
<PO_PHON>7032925197</PO_PHON>
</ProgramOfficer>
<AbstractNarration>This project develops the foundations of modeling, synthesis and development of verified medical device software and systems, from verified closed-loop models of the device and organ(s). The effort spans both implantable medical devices such as cardiac pacemakers and physiological control systems such as drug infusion pumps that have multiple networked medical systems. In both cases, the devices are physically connected to the body and exert direct control over the physiology and safety of the patient-in-the-loop. The goal is to ensure the device will never drive the patient into an unsafe state, while providing effective therapy. The contributions of are in three areas: closed-loop patient-device modeling; quantitative verification for optimized patient-specific devices; platforms for life-critical systems.  Integrated modeling methodologies are developed to produce both the functional physiological signals, for clinically relevant testing with a medical device, and also generate the formal timing of device-patient interaction for formal verification. Starting with the problem of verifying the safety and correctness of medical device software, probabilistic patient models based on physiological data are then used to develop quantitative verification techniques to maintain the therapy?s efficacy on the patient and operational efficiency of the device. To facilitate participation of the CPS community, the Food and Drug Administration (FDA), physicians and manufacturers, open source libraries of device/patient models, software tools for verification and model translation and hardware platforms for testing with real medical devices are developed.&lt;br/&gt; &lt;br/&gt;The closed-loop design and verification techniques for medical device software and patients, developed here, have direct potential benefits on human health, and the quality and cost of medical care.  Design of bug-free and safe medical device software is challenging, especially in complex implantable devices that control and actuate organs who's response is not fully understood. Safety recalls of pacemakers and implantable ?cardioverter? defibrillators between 1990 and 2000 affected over 600,000 devices. Of these, 200,000 or 41%, were due to firmware issues (i.e. software) that continue to increase in frequency. There is currently no formal methodology or open experimental platform to test and verify the correct operation of medical device software within the closed-loop context of the patient.  If successful, this project has potential to not only increase the safety of such devices, but also to accelerate the development and certification process.  The latter could reduce costs, and shorten the time to market for new devices.  The project also has an extensive education and outreach component, including curriculum development in medical cyber-physical systems, involvement of undergraduate and graduate students in research, and cooperation with hospitals, makers of medical devices, and the FDA. The cross-cutting nature of the project brings together communities involving clinical physicians, electrical engineers, computer scientists and regulators of health care safety.</AbstractNarration>
<MinAmdLetterDate>02/26/2013</MinAmdLetterDate>
<MaxAmdLetterDate>07/06/2017</MaxAmdLetterDate>
<ARRAAmount/>
<TRAN_TYPE>Grant</TRAN_TYPE>
<CFDA_NUM>47.070</CFDA_NUM>
<NSF_PAR_USE_FLAG>0</NSF_PAR_USE_FLAG>
<FUND_AGCY_CODE>4900</FUND_AGCY_CODE>
<AWDG_AGCY_CODE>4900</AWDG_AGCY_CODE>
<AwardID>1253842</AwardID>
<Investigator>
<FirstName>Rahul</FirstName>
<LastName>Mangharam</LastName>
<PI_MID_INIT/>
<PI_SUFX_NAME/>
<PI_FULL_NAME>Rahul Mangharam</PI_FULL_NAME>
<EmailAddress>rahulm@seas.upenn.edu</EmailAddress>
<PI_PHON>2158987293</PI_PHON>
<NSF_ID>000500237</NSF_ID>
<StartDate>02/26/2013</StartDate>
<EndDate/>
<RoleCode>Principal Investigator</RoleCode>
</Investigator>
<Institution>
<Name>University of Pennsylvania</Name>
<CityName>Philadelphia</CityName>
<ZipCode>191046205</ZipCode>
<PhoneNumber>2158987293</PhoneNumber>
<StreetAddress>Research Services</StreetAddress>
<StreetAddress2><![CDATA[3451 Walnut St, 5th Flr Franklin]]></StreetAddress2>
<CountryName>United States</CountryName>
<StateName>Pennsylvania</StateName>
<StateCode>PA</StateCode>
<CONGRESSDISTRICT>03</CONGRESSDISTRICT>
<CONGRESS_DISTRICT_ORG>PA03</CONGRESS_DISTRICT_ORG>
<ORG_DUNS_NUM>042250712</ORG_DUNS_NUM>
<ORG_LGL_BUS_NAME>TRUSTEES OF THE UNIVERSITY OF PENNSYLVANIA, THE</ORG_LGL_BUS_NAME>
<ORG_PRNT_DUNS_NUM>042250712</ORG_PRNT_DUNS_NUM>
</Institution>
<Performance_Institution>
<Name><![CDATA[University of Pennsylvania]]></Name>
<CityName/>
<StateCode>PA</StateCode>
<ZipCode>191046205</ZipCode>
<StreetAddress/>
<CountryCode>US</CountryCode>
<CountryName>United States</CountryName>
<StateName>Pennsylvania</StateName>
<CountryFlag>1</CountryFlag>
<CONGRESSDISTRICT>03</CONGRESSDISTRICT>
<CONGRESS_DISTRICT_PERF>PA03</CONGRESS_DISTRICT_PERF>
</Performance_Institution>
<ProgramElement>
<Code>7354</Code>
<Text>CSR-Computer Systems Research</Text>
</ProgramElement>
<ProgramElement>
<Code>7918</Code>
<Text>CPS-Cyber-Physical Systems</Text>
</ProgramElement>
<ProgramReference>
<Code>1045</Code>
<Text>CAREER-Faculty Erly Career Dev</Text>
</ProgramReference>
<ProgramReference>
<Code>1187</Code>
<Text>PECASE- eligible</Text>
</ProgramReference>
<ProgramReference>
<Code>7354</Code>
<Text>COMPUTER SYSTEMS</Text>
</ProgramReference>
<ProgramReference>
<Code>7918</Code>
<Text>CYBER-PHYSICAL SYSTEMS (CPS)</Text>
</ProgramReference>
<Appropriation>
<Code>0113</Code>
<Name>NSF RESEARCH &amp; RELATED ACTIVIT</Name>
<APP_SYMB_ID>040100</APP_SYMB_ID>
</Appropriation>
<Appropriation>
<Code>0114</Code>
<Name>NSF RESEARCH &amp; RELATED ACTIVIT</Name>
<APP_SYMB_ID>040100</APP_SYMB_ID>
</Appropriation>
<Appropriation>
<Code>0115</Code>
<Name>NSF RESEARCH &amp; RELATED ACTIVIT</Name>
<APP_SYMB_ID>040100</APP_SYMB_ID>
</Appropriation>
<Appropriation>
<Code>0116</Code>
<Name>NSF RESEARCH &amp; RELATED ACTIVIT</Name>
<APP_SYMB_ID>040100</APP_SYMB_ID>
</Appropriation>
<Appropriation>
<Code>0117</Code>
<Name>NSF RESEARCH &amp; RELATED ACTIVIT</Name>
<APP_SYMB_ID>040100</APP_SYMB_ID>
</Appropriation>
<FUND_OBLG>2013~82000</FUND_OBLG>
<FUND_OBLG>2014~82000</FUND_OBLG>
<FUND_OBLG>2015~82000</FUND_OBLG>
<FUND_OBLG>2016~82000</FUND_OBLG>
<FUND_OBLG>2017~82000</FUND_OBLG>
<POR>
<DRECONTENT><![CDATA[<div class="porColContainerWBG"> <div class="porContentCol"><div class="page" title="Page 3"> <div class="layoutArea"> <div class="column"> <p><span>The design of safe and bug-free medical device software and systems is a challenging task, especially in devices used for </span><span>physiological closed-loop control</span><span>. Software failures resulted in 24% of all medical device recalls in 2011, while almost 2,000,000 software-based devices have been recalled in the past decade. T</span>here is a need for formal design methodology and open experimental platforms to ensure the correct operation of medical devices within the closed-loop context. With effective modeling, formal verification and validation approaches, software-controlled medical devices will be able to reach the full potential in providing the best possible patient care and reducing the soaring healthcare costs. To this effect, this project focused on the development of high-confidence medical systems where a single device or several interoperable devices are used for physiological closed-loop control.</p> <p><strong>Intellectual Merit:</strong> This research has developed new approaches to integrated functional and formal modeling of closed-loop physiological systems and medical devices to ensure the safety under all possible physiological conditions. To address the challenge, the PI and his team developed:</p> <ol> <li><strong>Models of the heart and medical devices</strong>&nbsp;such as implantable pacemakers and implantable cardioverter defibrillators (ICDs). These models allow for both verification of the logic in the device such that it does not adversely affect the heart under all possible inputs from the heart to device. These verified formal models are then transformed automatically to simulation-based richer models for model-in-loop testing and then generated into code for embedded platforms for physical testing.&nbsp;</li> <li><strong>Automatic verification of device function</strong>&nbsp;was accomplished by generating a tree of model abstractions. This way, more abstract models covering more behavior coarsely can be used efficiently for simpler safety properties. For more complex safety properties, the model abstraction tree is automatically navigated to the most general model that expresses the the appropriate heart-device interaction to capture the interaction for complex properties.</li> <li><strong>Model translation tool for verified models to verified code</strong>&nbsp;was developed to&nbsp;demonstrate the value of integrated end-to-end modeling, verification, code-generation and testing process for complex software-controlled embedded systems.&nbsp;&nbsp;</li> <li><strong>Test Automation Platform for closed-loop medical devices</strong>&nbsp;was developed to evaluate the tolerance necessary by verification approaches using abstract models of the system so that the code generated by those verified models does work as specified with a robust timing and memory footprint margin.&nbsp;</li> <li><strong>Outreach activities</strong>&nbsp;with high-school students, undergraduates, REUs, industry groups (Mathworks, BMES, ASME, Medical Device Industry Consortium) and regulatory agencies (FDA) were conducted to communicate the importance of medical device software verification and testing.</li> <li><strong>Dissemination of research results to the community and in education:</strong>&nbsp;The models and tools developed in this research have been downloaded several hundred times and are used as reference models for researchers working on medical cyber-physical systems in several institutions. We continue to support the community and maintain the models/tools. The outcome of this effort has be integrated into a graduate-level course on Digital Twins: Model-based Embedded Systems to capture key techniques to address the hazards and risks in software development for life-critical systems.&nbsp;</li> </ol> <p>This project produced several national and international impactful outcomes:</p> <ol> <li>The PI was awarded the 2016 PECASE for this effort</li> <li>This work resulted in over 26 direct publications and 3 PhD Thesis</li> <li>The models developed are open-sourced and are being extensively used by the Medical Cyber-Physical Systems community</li> <li>This work is captured in a course that is now taught at UPenn, UVA, Oregon State University, ShanghaiTech University and University of Northern Arizona - Digital Twins: Model-based Embedded Systems</li> <li>The primary students supported by this research are tenure-track Assistant Professors in Duke University, ShanghaiTech University, and Oregon State University.&nbsp;</li> <li>Several REU students were mentored in the development of testing, hardware platforms and verification. Three went on to pursue graduate school successfully.&nbsp;</li> <li>This work won one Best Paper Award at CPSweek, Best in Session award at Semiconductor Research Corporation's TECHCON, and was nominated for another Best Paper Award in TACAS.</li> </ol></div> </div> </div> <p>&nbsp;</p> <p><span><strong>Broader Impacts:</strong> This project brings to light the life-critical nature of embedded software in medical devices and provides a framework to address the safety hazards in the design and development of these devices in the closed-loop contest of the physiological system.&nbsp;</span>Several hardware prototypes and testbeds were developed and demonstrated to show how formal verification can realize working code to interface with real medical devices. All models, tools and software developed in this project are free and open-source at http://medcps.org</p> <p>&nbsp;</p><br> <p>            Last Modified: 10/27/2019<br>      Modified by: Rahul&nbsp;Mangharam</p> </div> <div class="porSideCol"> <div class="each-gallery"> <div class="galContent" id="gallery0"> <div class="photoCount" id="photoCount0">          Images (<span id="selectedPhoto0">1</span> of <span class="totalNumber"></span>)           </div> <div class="galControls" id="controls0"></div> <div class="galSlideshow" id="slideshow0"></div> <div class="galEmbox" id="embox"> <div class="image-title"></div> </div> </div> <div class="galNavigation" id="navigation0"> <ul class="thumbs" id="thumbs0"> <li> <a href="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195873588_Heart-on-a-chipplatform--rgov-214x142.jpg" original="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195873588_Heart-on-a-chipplatform--rgov-800width.jpg" title="Heart-on-a-chip platform"><img src="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195873588_Heart-on-a-chipplatform--rgov-66x44.jpg" alt="Heart-on-a-chip platform"></a> <div class="imageCaptionContainer"> <div class="imageCaption">Heart-on-a-chip platform</div> <div class="imageCredit">Rahul Mangharam</div> <div class="imagePermisssions">Copyrighted</div> <div class="imageSubmitted">Rahul&nbsp;Mangharam</div> <div class="imageTitle">Heart-on-a-chip platform</div> </div> </li> <li> <a href="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195535655_Closed-loopInteractiveHeartMoldel--rgov-214x142.jpg" original="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195535655_Closed-loopInteractiveHeartMoldel--rgov-800width.jpg" title="Closed-loop Interactive Heart Model"><img src="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195535655_Closed-loopInteractiveHeartMoldel--rgov-66x44.jpg" alt="Closed-loop Interactive Heart Model"></a> <div class="imageCaptionContainer"> <div class="imageCaption">Closed-loop Interactive Heart Model</div> <div class="imageCredit">Rahul Mangharam</div> <div class="imagePermisssions">Public Domain</div> <div class="imageSubmitted">Rahul&nbsp;Mangharam</div> <div class="imageTitle">Closed-loop Interactive Heart Model</div> </div> </li> <li> <a href="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195593109_MBCTtoolchain--rgov-214x142.jpg" original="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195593109_MBCTtoolchain--rgov-800width.jpg" title="Model-based Clinical Trials toolchain"><img src="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195593109_MBCTtoolchain--rgov-66x44.jpg" alt="Model-based Clinical Trials toolchain"></a> <div class="imageCaptionContainer"> <div class="imageCaption">Model-based Clinical Trials toolchain</div> <div class="imageCredit">Rahul Mangharam</div> <div class="imagePermisssions">Public Domain</div> <div class="imageSubmitted">Rahul&nbsp;Mangharam</div> <div class="imageTitle">Model-based Clinical Trials toolchain</div> </div> </li> <li> <a href="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195804325_Multi-scalemodelingforclosed-loopmedicaldeviceandheartmodelinteraction--rgov-214x142.jpg" original="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195804325_Multi-scalemodelingforclosed-loopmedicaldeviceandheartmodelinteraction--rgov-800width.jpg" title="Multi-scale modeling for closed-loop medical device and heart model interaction"><img src="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195804325_Multi-scalemodelingforclosed-loopmedicaldeviceandheartmodelinteraction--rgov-66x44.jpg" alt="Multi-scale modeling for closed-loop medical device and heart model interaction"></a> <div class="imageCaptionContainer"> <div class="imageCaption">Multi-scale modeling for closed-loop medical device and heart model interaction</div> <div class="imageCredit">Rahul Mangharam</div> <div class="imagePermisssions">Public Domain</div> <div class="imageSubmitted">Rahul&nbsp;Mangharam</div> <div class="imageTitle">Multi-scale modeling for closed-loop medical device and heart model interaction</div> </div> </li> <li> <a href="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195359954_Slide12--rgov-214x142.jpg" original="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195359954_Slide12--rgov-800width.jpg" title="Medical Cyber-Physical Systems"><img src="/por/images/Reports/POR/2019/1253842/1253842_10233908_1572195359954_Slide12--rgov-66x44.jpg" alt="Medical Cyber-Physical Systems"></a> <div class="imageCaptionContainer"> <div class="imageCaption">From verified models of the closed-loop medical device and physiology to verified code for safe operation of the device in the context of the physiology</div> <div class="imageCredit">Rahul Mangharam</div> <div class="imagePermisssions">Public Domain</div> <div class="imageSubmitted">Rahul&nbsp;Mangharam</div> <div class="imageTitle">Medical Cyber-Physical Systems</div> </div> </li> </ul> </div> </div> </div> </div>]]></DRECONTENT>
<POR_COPY_TXT><![CDATA[    The design of safe and bug-free medical device software and systems is a challenging task, especially in devices used for physiological closed-loop control. Software failures resulted in 24% of all medical device recalls in 2011, while almost 2,000,000 software-based devices have been recalled in the past decade. There is a need for formal design methodology and open experimental platforms to ensure the correct operation of medical devices within the closed-loop context. With effective modeling, formal verification and validation approaches, software-controlled medical devices will be able to reach the full potential in providing the best possible patient care and reducing the soaring healthcare costs. To this effect, this project focused on the development of high-confidence medical systems where a single device or several interoperable devices are used for physiological closed-loop control.  Intellectual Merit: This research has developed new approaches to integrated functional and formal modeling of closed-loop physiological systems and medical devices to ensure the safety under all possible physiological conditions. To address the challenge, the PI and his team developed:  Models of the heart and medical devices such as implantable pacemakers and implantable cardioverter defibrillators (ICDs). These models allow for both verification of the logic in the device such that it does not adversely affect the heart under all possible inputs from the heart to device. These verified formal models are then transformed automatically to simulation-based richer models for model-in-loop testing and then generated into code for embedded platforms for physical testing.  Automatic verification of device function was accomplished by generating a tree of model abstractions. This way, more abstract models covering more behavior coarsely can be used efficiently for simpler safety properties. For more complex safety properties, the model abstraction tree is automatically navigated to the most general model that expresses the the appropriate heart-device interaction to capture the interaction for complex properties. Model translation tool for verified models to verified code was developed to demonstrate the value of integrated end-to-end modeling, verification, code-generation and testing process for complex software-controlled embedded systems.   Test Automation Platform for closed-loop medical devices was developed to evaluate the tolerance necessary by verification approaches using abstract models of the system so that the code generated by those verified models does work as specified with a robust timing and memory footprint margin.  Outreach activities with high-school students, undergraduates, REUs, industry groups (Mathworks, BMES, ASME, Medical Device Industry Consortium) and regulatory agencies (FDA) were conducted to communicate the importance of medical device software verification and testing. Dissemination of research results to the community and in education: The models and tools developed in this research have been downloaded several hundred times and are used as reference models for researchers working on medical cyber-physical systems in several institutions. We continue to support the community and maintain the models/tools. The outcome of this effort has be integrated into a graduate-level course on Digital Twins: Model-based Embedded Systems to capture key techniques to address the hazards and risks in software development for life-critical systems.    This project produced several national and international impactful outcomes:  The PI was awarded the 2016 PECASE for this effort This work resulted in over 26 direct publications and 3 PhD Thesis The models developed are open-sourced and are being extensively used by the Medical Cyber-Physical Systems community This work is captured in a course that is now taught at UPenn, UVA, Oregon State University, ShanghaiTech University and University of Northern Arizona - Digital Twins: Model-based Embedded Systems The primary students supported by this research are tenure-track Assistant Professors in Duke University, ShanghaiTech University, and Oregon State University.  Several REU students were mentored in the development of testing, hardware platforms and verification. Three went on to pursue graduate school successfully.  This work won one Best Paper Award at CPSweek, Best in Session award at Semiconductor Research Corporation's TECHCON, and was nominated for another Best Paper Award in TACAS.        Broader Impacts: This project brings to light the life-critical nature of embedded software in medical devices and provides a framework to address the safety hazards in the design and development of these devices in the closed-loop contest of the physiological system. Several hardware prototypes and testbeds were developed and demonstrated to show how formal verification can realize working code to interface with real medical devices. All models, tools and software developed in this project are free and open-source at http://medcps.org          Last Modified: 10/27/2019       Submitted by: Rahul Mangharam]]></POR_COPY_TXT>
</POR>
</Award>
</rootTag>
