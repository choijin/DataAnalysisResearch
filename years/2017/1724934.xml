<?xml version="1.0" encoding="UTF-8"?>
<rootTag>
<Award>
<AwardTitle>NeTS: Small: A Language-Based Approach to Deep Packet Inspection: from Theory to Practice</AwardTitle>
<AGENCY>NSF</AGENCY>
<AwardEffectiveDate>01/01/2017</AwardEffectiveDate>
<AwardExpirationDate>01/31/2018</AwardExpirationDate>
<AwardTotalIntnAmount>94326.00</AwardTotalIntnAmount>
<AwardAmount>94326</AwardAmount>
<AwardInstrument>
<Value>Standard Grant</Value>
</AwardInstrument>
<Organization>
<Code>05050000</Code>
<Directorate>
<Abbreviation>CSE</Abbreviation>
<LongName>Direct For Computer &amp; Info Scie &amp; Enginr</LongName>
</Directorate>
<Division>
<Abbreviation>CNS</Abbreviation>
<LongName>Division Of Computer and Network Systems</LongName>
</Division>
</Organization>
<ProgramOfficer>
<SignBlockName>John Brassil</SignBlockName>
<PO_EMAI/>
<PO_PHON/>
</ProgramOfficer>
<AbstractNarration>Deep packet inspection is at the core of several established and emerging networking applications, such as network intrusion detection and content-aware routing. Due to their expressive power, in recent years regular expressions have been adopted in pattern-sets used for these applications in both industry and academia. Existing high-performance regular expression matching engines are based on finite automata, and are implemented using either logic- or memory-based designs. The former allow peak performance on single packet flows with relatively simple logic, but are not scalable to large numbers of flows; the latter offer scalability in the number of flows at the cost of algorithmic and design complexity. Despite the rich body of work in the area, providing worst-case guarantees is still challenging in the presence of complex regular expressions that include repetitions of wildcards and large character sets. Moreover, existing solutions assume that packets are inspected in-order and after data decompression. &lt;br/&gt;&lt;br/&gt;This project will develop a language abstraction, data structures, and algorithms for line rate deep packet inspection. In particular, the project will consider open problems in regular expression-based deep packet inspection, namely: (i) handling of complex patterns containing repetitions of wildcards and large character sets, and (ii) inspection of out-of-order packets and compressed traffic. A language-based approach to deep packet inspection will be introduced in order to handle the regular expressions? complexity. This project will integrate concepts from automata theory, practices in data structure and algorithm design, analysis of the requirements of networking applications, and system architecture considerations. &lt;br/&gt;&lt;br/&gt;The previous work performed by the PI on high speed regular expression matching has attracted the attention of several companies.  The PI will leverage these contacts to facilitate the transfer of the proposed research. The PI has added two computer architecture courses to the undergraduate and graduate Electrical and Computer Engineering curriculum at University of Missouri (MU); she will introduce a new networking systems course, which will cover the knowledge generated by this research. The PI will leverage the MU Undergraduate Research Program to involve undergraduate students in the proposed work, which will allow students to work at the intersection of three domains: algorithm and data structure design, system architecture and networking applications. The results of this research will be disseminated through publications and presentations, and by releasing open-source software modules on the PI?s Lab website.</AbstractNarration>
<MinAmdLetterDate>02/22/2017</MinAmdLetterDate>
<MaxAmdLetterDate>02/22/2017</MaxAmdLetterDate>
<ARRAAmount/>
<TRAN_TYPE>Grant</TRAN_TYPE>
<CFDA_NUM>47.070</CFDA_NUM>
<NSF_PAR_USE_FLAG>0</NSF_PAR_USE_FLAG>
<FUND_AGCY_CODE>4900</FUND_AGCY_CODE>
<AWDG_AGCY_CODE>4900</AWDG_AGCY_CODE>
<AwardID>1724934</AwardID>
<Investigator>
<FirstName>Michela</FirstName>
<LastName>Becchi</LastName>
<PI_MID_INIT/>
<PI_SUFX_NAME/>
<PI_FULL_NAME>Michela Becchi</PI_FULL_NAME>
<EmailAddress>mbecchi@ncsu.edu</EmailAddress>
<PI_PHON>9195152440</PI_PHON>
<NSF_ID>000573363</NSF_ID>
<StartDate>02/22/2017</StartDate>
<EndDate/>
<RoleCode>Principal Investigator</RoleCode>
</Investigator>
<Institution>
<Name>North Carolina State University</Name>
<CityName>Raleigh</CityName>
<ZipCode>276957514</ZipCode>
<PhoneNumber>9195152444</PhoneNumber>
<StreetAddress>2601 Wolf Village Way</StreetAddress>
<StreetAddress2><![CDATA[Admin. III, STE 240]]></StreetAddress2>
<CountryName>United States</CountryName>
<StateName>North Carolina</StateName>
<StateCode>NC</StateCode>
<CONGRESSDISTRICT>04</CONGRESSDISTRICT>
<CONGRESS_DISTRICT_ORG>NC04</CONGRESS_DISTRICT_ORG>
<ORG_DUNS_NUM>042092122</ORG_DUNS_NUM>
<ORG_LGL_BUS_NAME>NORTH CAROLINA STATE UNIVERSITY</ORG_LGL_BUS_NAME>
<ORG_PRNT_DUNS_NUM>142363428</ORG_PRNT_DUNS_NUM>
</Institution>
<Performance_Institution>
<Name><![CDATA[North Carolina State University]]></Name>
<CityName/>
<StateCode>NC</StateCode>
<ZipCode>276957003</ZipCode>
<StreetAddress/>
<CountryCode>US</CountryCode>
<CountryName>United States</CountryName>
<StateName>North Carolina</StateName>
<CountryFlag>1</CountryFlag>
<CONGRESSDISTRICT>02</CONGRESSDISTRICT>
<CONGRESS_DISTRICT_PERF>NC02</CONGRESS_DISTRICT_PERF>
</Performance_Institution>
<ProgramElement>
<Code>7363</Code>
<Text>Networking Technology and Syst</Text>
</ProgramElement>
<ProgramReference>
<Code>7923</Code>
<Text>SMALL PROJECT</Text>
</ProgramReference>
<ProgramReference>
<Code>9102</Code>
<Text>WOMEN, MINORITY, DISABLED, NEC</Text>
</ProgramReference>
<Appropriation>
<Code>0113</Code>
<Name>NSF RESEARCH &amp; RELATED ACTIVIT</Name>
<APP_SYMB_ID>040100</APP_SYMB_ID>
</Appropriation>
<FUND_OBLG>2013~94326</FUND_OBLG>
<POR>
<DRECONTENT><![CDATA[<div class="porColContainerWBG"> <div class="porContentCol"><p>Deep packet inspection is at the core of several established and emerging networking applications, such as network intrusion detection and content-aware routing. Due to their expressive power, in recent years regular expressions have been adopted in pattern-sets used for these applications in both industry and academia. Existing high-performance regular expression matching engines are based on finite automata, and are implemented using either logic- or memory-based designs. The former allow peak performance on single packet flows with relatively simple logic, but are not scalable to large numbers of flows; the latter offer scalability in the number of flows at the cost of algorithmic and design complexity. Despite the rich body of work in the area, providing worst-case guarantees is still challenging in the presence of complex regular expressions that include repetitions of wildcards and large character sets. Moreover, existing solutions assume that packets are inspected in-order and after data decompression.&nbsp;</p> <p><strong>Intellectual Merit:</strong> This project has addressed open problems in regular expression-based deep packet inspection, namely: (i) design of algorithmic techniques to inspect out-of-order packets and compressed traffic, and (ii) design of automata abstractions and mechanisms to handle complex patterns containing repetitions of wildcards and large character sets. In addition, the project has explored the implementation of the proposed techniques on different parallel hardware, including memory-centric platforms (such as general-purpose processors, GPUs and Micron&rsquo;s Automata Processor) and field-programmable gate arrays (FPGAs). This project has integrated concepts from automata theory, practices in data structure and algorithm design, analysis of the requirements of networking applications, and system architecture considerations.&nbsp;</p> <p>More specifically, the project has led to the following outcomes. First, we have designed a regular expression matching engine (called ARCH) that allows performing deep packet inspection on HTTP traffic compressed using the GZIP protocol without requiring prior packet decompression (results presented in INFOCOM 2015 paper). Second, we have developed a pattern-matching engine (called O<sup>3</sup>FA) to perform deep packet inspection on out-of-order packets without requiring prior flow reassembly (results presented in ANCS 2016 paper). Third, we have addressed complex regular expressions that include wildcard and large character set repetitions, typically leading to state explosion or vulnerability to algorithmic attacks when handled through traditional finite automata, either in their deterministic or non-deterministic form (DFA and NFA, respectively). Specifically, we have designed a new automata abstraction, called JFA, which uses state variables in order to avoid state explosion, and is <em>by construction</em> functionally equivalent to the corresponding DFA (JSAC 2014 paper; see attached &ldquo;JFA example&rdquo; image). Third, we have made a comprehensive exploration of different platforms &ndash; namely GPUs, FPGAs, and Micron&rsquo;s Automata Processors &ndash; as automata accelerators for large-scale datasets. To this end, we have developed a compiler tool-chain that allows the seamless deployment of large sets of regular expression onto these platforms. Our evaluation has covered preprocessing cost, pattern matching performance, pattern density (i.e., resource requirements), and power consumption (IPDPS 2016 and ICS 2017 papers; see attached &ldquo;ICS 2017 tool-chain&rdquo; image). Fourth, we have designed a novel hardware architecture (called Unified Automata Processor, or UAP) that supports a wide range of existing finite automata models (DFAs, NFAs, A-DFAs, JFAs, counting-DFAs, and counting-NFAs) efficiently, and we have demonstrated the performance and energy advantages of this architecture over Micron&rsquo;s Automata Processor, GPUs, and existing custom automata accelerators (MICRO 2015 paper; see attached &ldquo;UAP architecture&rdquo; image). Fifth, we have designed a novel memory-efficient GPU engine for patterns that can be more easily represented through automata rather than through regular expressions; namely, those enabling Hamming and Levenshtein distance matching (HiPC 2017 paper). As a side contribution, we have defined a Haskell-based approach to regular expression matching, and we have provided a compiler from a subset of Haskell to FPGA (LCTES 2015, ARC 2015 and ReCoSoC 2016 papers).</p> <p><strong>Broader Impacts:</strong> This award has supported one Ph.D. student and several M.S. students; students working on this project have obtained internships and permanent positions at AT&amp;T Labs, Micron Technologies, Facebook, and Intel. This project has enabled collaboration with researchers at the Interdisciplinary Center Herzliya (Israel), the Hebrew University Jerusalem (Israel), the University of Chicago, Virginia Tech, and U. California San Diego. From the curriculum development angle, this project has allowed the creation of a new Network Systems Architecture course at University of Missouri. In addition, this work has sparked interest from several IT companies, such as Micron Technologies and Intel. The PI has exchanged datasets and code with these industries.</p> <p>&nbsp;</p><br> <p>            Last Modified: 03/29/2018<br>      Modified by: Michela&nbsp;Becchi</p> </div> <div class="porSideCol"> <div class="each-gallery"> <div class="galContent" id="gallery0"> <div class="photoCount" id="photoCount0">          Images (<span id="selectedPhoto0">1</span> of <span class="totalNumber"></span>)           </div> <div class="galControls" id="controls0"></div> <div class="galSlideshow" id="slideshow0"></div> <div class="galEmbox" id="embox"> <div class="image-title"></div> </div> </div> <div class="galNavigation" id="navigation0"> <ul class="thumbs" id="thumbs0"> <li> <a href="/por/images/Reports/POR/2018/1724934/1724934_10268573_1522294452164_JFA--rgov-214x142.jpg" original="/por/images/Reports/POR/2018/1724934/1724934_10268573_1522294452164_JFA--rgov-800width.jpg" title="JFA example"><img src="/por/images/Reports/POR/2018/1724934/1724934_10268573_1522294452164_JFA--rgov-66x44.jpg" alt="JFA example"></a> <div class="imageCaptionContainer"> <div class="imageCaption">(a) unoptimized l-NFA accepting regular expressions ac.*cdh and ec.*cgi; (b) initial sketch of the corresponding JFA (including only the entry state and the states directly connected to it); (c) l-NFA optimized through label splitting and forwarding; and (d) sketch of the corresponding JFA.</div> <div class="imageCredit">Xiaodong Xu, Michela Becchi</div> <div class="imagePermisssions">Public Domain</div> <div class="imageSubmitted">Michela&nbsp;Becchi</div> <div class="imageTitle">JFA example</div> </div> </li> <li> <a href="/por/images/Reports/POR/2018/1724934/1724934_10268573_1522294453976_UAP--rgov-214x142.jpg" original="/por/images/Reports/POR/2018/1724934/1724934_10268573_1522294453976_UAP--rgov-800width.jpg" title="UAP Architecture"><img src="/por/images/Reports/POR/2018/1724934/1724934_10268573_1522294453976_UAP--rgov-66x44.jpg" alt="UAP Architecture"></a> <div class="imageCaptionContainer"> <div class="imageCaption">UAP Architecture</div> <div class="imageCredit">K. Fang, T. Hoang, M. Becchi and A. Chien</div> <div class="imagePermisssions">Public Domain</div> <div class="imageSubmitted">Michela&nbsp;Becchi</div> <div class="imageTitle">UAP Architecture</div> </div> </li> <li> <a href="/por/images/Reports/POR/2018/1724934/1724934_10268573_1522294621385_toolchain--rgov-214x142.jpg" original="/por/images/Reports/POR/2018/1724934/1724934_10268573_1522294621385_toolchain--rgov-800width.jpg" title="ICS 2017 tool-chain"><img src="/por/images/Reports/POR/2018/1724934/1724934_10268573_1522294621385_toolchain--rgov-66x44.jpg" alt="ICS 2017 tool-chain"></a> <div class="imageCaptionContainer"> <div class="imageCaption">Toolchain for the automatic deployment of large regular expression datasets on FPGA, GPU and Micron's Automata Processor. The toolchain performs parsing, NFA partitioning, platform-independent and platform-specific optimizations.</div> <div class="imageCredit">Marziyeh Nourian and Michela Becchi</div> <div class="imagePermisssions">Public Domain</div> <div class="imageSubmitted">Michela&nbsp;Becchi</div> <div class="imageTitle">ICS 2017 tool-chain</div> </div> </li> </ul> </div> </div> </div> </div>]]></DRECONTENT>
<POR_COPY_TXT><![CDATA[ Deep packet inspection is at the core of several established and emerging networking applications, such as network intrusion detection and content-aware routing. Due to their expressive power, in recent years regular expressions have been adopted in pattern-sets used for these applications in both industry and academia. Existing high-performance regular expression matching engines are based on finite automata, and are implemented using either logic- or memory-based designs. The former allow peak performance on single packet flows with relatively simple logic, but are not scalable to large numbers of flows; the latter offer scalability in the number of flows at the cost of algorithmic and design complexity. Despite the rich body of work in the area, providing worst-case guarantees is still challenging in the presence of complex regular expressions that include repetitions of wildcards and large character sets. Moreover, existing solutions assume that packets are inspected in-order and after data decompression.   Intellectual Merit: This project has addressed open problems in regular expression-based deep packet inspection, namely: (i) design of algorithmic techniques to inspect out-of-order packets and compressed traffic, and (ii) design of automata abstractions and mechanisms to handle complex patterns containing repetitions of wildcards and large character sets. In addition, the project has explored the implementation of the proposed techniques on different parallel hardware, including memory-centric platforms (such as general-purpose processors, GPUs and Micron?s Automata Processor) and field-programmable gate arrays (FPGAs). This project has integrated concepts from automata theory, practices in data structure and algorithm design, analysis of the requirements of networking applications, and system architecture considerations.   More specifically, the project has led to the following outcomes. First, we have designed a regular expression matching engine (called ARCH) that allows performing deep packet inspection on HTTP traffic compressed using the GZIP protocol without requiring prior packet decompression (results presented in INFOCOM 2015 paper). Second, we have developed a pattern-matching engine (called O3FA) to perform deep packet inspection on out-of-order packets without requiring prior flow reassembly (results presented in ANCS 2016 paper). Third, we have addressed complex regular expressions that include wildcard and large character set repetitions, typically leading to state explosion or vulnerability to algorithmic attacks when handled through traditional finite automata, either in their deterministic or non-deterministic form (DFA and NFA, respectively). Specifically, we have designed a new automata abstraction, called JFA, which uses state variables in order to avoid state explosion, and is by construction functionally equivalent to the corresponding DFA (JSAC 2014 paper; see attached "JFA example" image). Third, we have made a comprehensive exploration of different platforms &ndash; namely GPUs, FPGAs, and Micron?s Automata Processors &ndash; as automata accelerators for large-scale datasets. To this end, we have developed a compiler tool-chain that allows the seamless deployment of large sets of regular expression onto these platforms. Our evaluation has covered preprocessing cost, pattern matching performance, pattern density (i.e., resource requirements), and power consumption (IPDPS 2016 and ICS 2017 papers; see attached "ICS 2017 tool-chain" image). Fourth, we have designed a novel hardware architecture (called Unified Automata Processor, or UAP) that supports a wide range of existing finite automata models (DFAs, NFAs, A-DFAs, JFAs, counting-DFAs, and counting-NFAs) efficiently, and we have demonstrated the performance and energy advantages of this architecture over Micron?s Automata Processor, GPUs, and existing custom automata accelerators (MICRO 2015 paper; see attached "UAP architecture" image). Fifth, we have designed a novel memory-efficient GPU engine for patterns that can be more easily represented through automata rather than through regular expressions; namely, those enabling Hamming and Levenshtein distance matching (HiPC 2017 paper). As a side contribution, we have defined a Haskell-based approach to regular expression matching, and we have provided a compiler from a subset of Haskell to FPGA (LCTES 2015, ARC 2015 and ReCoSoC 2016 papers).  Broader Impacts: This award has supported one Ph.D. student and several M.S. students; students working on this project have obtained internships and permanent positions at AT&amp;T Labs, Micron Technologies, Facebook, and Intel. This project has enabled collaboration with researchers at the Interdisciplinary Center Herzliya (Israel), the Hebrew University Jerusalem (Israel), the University of Chicago, Virginia Tech, and U. California San Diego. From the curriculum development angle, this project has allowed the creation of a new Network Systems Architecture course at University of Missouri. In addition, this work has sparked interest from several IT companies, such as Micron Technologies and Intel. The PI has exchanged datasets and code with these industries.          Last Modified: 03/29/2018       Submitted by: Michela Becchi]]></POR_COPY_TXT>
</POR>
</Award>
</rootTag>
